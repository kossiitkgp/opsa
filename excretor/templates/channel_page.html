<!-- templates/channel_page.html -->
<div id="page-since-{{last_msg_timestamp}}">
    {% for (message, user) in messages %}
    <div
        class="message"
        id="{{ message.timestamp }}{{ message.user_id}}"
    >
        <img
            class="avatar"
            src="{{ user.image_url }}"
            alt="User Avatar"
            hx-trigger="error"
            hx-swap="outerHTML"
            hx-get="/fallback-avatar"
            hx-target="this"
        />
        <div class="message-inner-container">
            <div class="user-and-time">
                <span class="name">{{ user.name }}</span>
                <span class="time">
                    {{ message.formatted_timestamp }}
                </span>
            </div>
            <div class="message-content">
                {{ message.text|safe }}
            </div>
        </div>
    </div>
    {% endfor %}

    {% if self::generate_trigger(messages) %}
    <div 
        hx-get="/messages/{{ channel_id }}?last_msg_timestamp={{ last_msg_timestamp }}&per_page=10" 
        hx-trigger="intersect once" 
        hx-swap="beforeend" 
        hx-target=".message-container" 
    ></div> 
    {% endif %}
</div>
